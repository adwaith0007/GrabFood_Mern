import{j as t,u as _,r as a,L as q,m as R,o as D,i as l,b as O,p as Q,_ as u,q as W}from"./index-I3DWyLzt.js";const G=({name:c,imageUrl:g,handler:d})=>{const h=()=>{d(c)};return t.jsx("div",{className:"flex flex-col  items-center gap-3",children:t.jsxs("button",{onClick:h,children:[t.jsx("div",{className:"w-[200px] h-[192px]  rounded-[100%] flex justify-center overflow-hidden shadow-md",children:t.jsx("img",{className:"object-cover cursor-pointer ",src:g,alt:""})}),t.jsx("h3",{className:"font-bold",children:c})]})})},J=({productId:c,price:g,name:d,discountPrice:h,offerInPercentage:x,description:N,imageUrl:L,onAddToCart:C})=>{const{user:n}=_(r=>r.userReducer),m=n._id,[f,p]=a.useState([]),j=async()=>{try{const r=await l.get(`/user/${m}/wishlist`);r.data.success?p(r.data.data):console.error("Failed to fetch user orders:",r.data.error)}catch(r){console.error("Error fetching user orders:",r)}};console.log("data:",f),a.useEffect(()=>{j()},[m]);const s=async()=>{try{const r=n._id;(await l.post("/user/wishlist/add",{userId:r,productId:c})).data.success&&j()}catch(r){console.error(r)}};return t.jsxs("div",{className:"relative m-10 flex w-full max-w-xs  flex-col overflow-hidden rounded-lg border border-gray-100 bg-white shadow-md",children:[t.jsxs(q,{className:"relative mx-3 mt-3 flex h-60 overflow-hidden rounded-xl",to:`/product/${c}`,children:[t.jsx("img",{className:"object-cover",src:L,alt:"product image"}),x&&t.jsxs("span",{className:"absolute top-0 left-0 m-2 rounded-full bg-black px-2 text-center text-sm font-medium text-white",children:[x,"% OFF"]})]}),t.jsx("button",{onClick:s,className:" absolute z-10 top-0 right-0 mt-4 mr-6 rounded-full bg-black px-2 border focus:outline-none",children:t.jsx(R,{icon:D,color:f.some(r=>r.productId===c)?"red":"white"})}),t.jsxs("div",{className:"mt-4 px-5 pb-5",children:[t.jsx("a",{href:"#",children:t.jsx("h5",{className:"text-xl tracking-tight text-slate-900 line-clamp-1 ",children:d})}),t.jsxs("div",{className:"mt-2 mb-2 flex items-center justify-between",children:[h?t.jsxs("p",{children:[t.jsxs("span",{className:"text-3xl font-bold text-slate-900",children:["₹",h]}),t.jsxs("span",{className:"text-sm text-slate-900 line-through",children:["₹",g]})]}):t.jsx("p",{children:t.jsxs("span",{className:"text-3xl font-bold text-slate-900",children:["₹",g]})}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{"aria-hidden":"true",className:"h-5 w-5 text-yellow-300",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),t.jsx("svg",{"aria-hidden":"true",className:"h-5 w-5 text-yellow-300",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),t.jsx("svg",{"aria-hidden":"true",className:"h-5 w-5 text-yellow-300",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),t.jsx("svg",{"aria-hidden":"true",className:"h-5 w-5 text-yellow-300",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),t.jsx("svg",{"aria-hidden":"true",className:"h-5 w-5 text-yellow-300",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),t.jsx("span",{className:"mr-2 ml-3 rounded bg-yellow-200 px-2.5 py-0.5 text-xs font-semibold",children:"5.0"})]})]}),t.jsx("div",{className:"px-4 mb-4 overflow-hidden h-10 ",children:t.jsx("p",{className:"text-sm text-slate-900 line-clamp-2",children:N})}),t.jsxs("button",{onClick:C,className:"flex w-full items-center justify-center rounded-md bg-slate-900 px-5 py-2.5 text-center text-sm font-medium text-white hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-blue-300",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mr-2 h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),"Add to cart"]})]})]})},P="https://www.grabfood.life",V=()=>{const{user:c}=_(e=>e.userReducer),g=O(),d=c._id,h=Q(),x=new URLSearchParams(h.search).get("q"),[N,L]=a.useState([]),[C,n]=a.useState([]),[m,f]=a.useState([]),[p,j]=a.useState(""),[s,r]=a.useState(1),[w,y]=a.useState(1),[$,I]=a.useState(!1),v=a.useRef(null),b=8,[F,S]=a.useState([]),H=async()=>{try{const e=await l.get(`/user/${d}/wishlist`);e.data.success?S(e.data.data):console.error("Failed to fetch user orders:",e.data.error)}catch(e){console.error("Error fetching user orders:",e)}};console.log("data:",F),a.useEffect(()=>{H()},[d]),a.useEffect(()=>{try{l.get("/category/get").then(e=>{e.data.success&&L(e.data.data)})}catch(e){u.error("Error while loading categories"),console.log(e)}},[]),a.useEffect(()=>{x?T(x):E()},[p,s,x]),a.useEffect(()=>{E()},[p,s]),a.useEffect(()=>{function e(o){v.current&&!v.current.contains(o.target)&&I(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[v]);const E=()=>{try{l.get(`/product/get?category=${p}&page=${s}&limit=${b}`).then(e=>{e.data.success&&(n(e.data.data),y(e.data.totalPages))})}catch(e){u.error("Error while loading products"),console.log(e)}},M=()=>{try{l.get(`/product/get_best?category=${p}&page=${s}&limit=${b}`).then(e=>{e.data.success&&(n(e.data.data),y(e.data.totalPages))})}catch(e){u.error("Error while loading products"),console.log(e)}},B=async()=>{try{const e=await l.get(`/product/get_LowToHigh?page=${s}&limit=${b}`);e.data.success?(n(e.data.data),y(e.data.totalPages)):console.error("Unsuccessful response from the API:",e.data.message)}catch(e){u.error("Error while loading products"),console.error("API call error:",e)}},z=async()=>{try{const e=await l.get(`/product/get_HighToLow?page=${s}&limit=${b}`);e.data.success?(n(e.data.data),y(e.data.totalPages)):console.error("Unsuccessful response from the API:",e.data.message)}catch(e){u.error("Error while loading products"),console.error("API call error:",e)}},T=e=>{try{l.get(`/product/search?q=${e}&page=${s}&limit=${b}`).then(o=>{o.data.success&&(n(o.data.data),y(o.data.totalPages))})}catch(o){u.error("Error while searching products"),console.log(o)}},A=e=>{if(l.post(`/cart/add/${d}`,{product:e,quantity:1}).then(i=>console.log("Product added to cart:",i.data)).catch(i=>console.error("Error adding to cart:",i)),m.find(i=>i.productId===e._id)){const i=m.map(k=>k.productId===e._id?{...k,quantity:k.quantity+1}:k);f(i)}else g(W(e.productName)),f([...m,{productId:e._id,quantity:1,name:e.productName,price:e.price,imageUrl:`${P}/${e.productImage[0].replace(/ /g,"%20")}`}]);u.success(`${e.productName} added to cart!`)},U=e=>{j(e),r(1)};return t.jsxs("div",{className:"bg-[#e5d9ca] h-full ",children:[t.jsxs("div",{className:"container custom-height flex flex-col justify-center items-center mx-auto  ",children:[t.jsx("div",{className:"flex gap-4",children:N.map(e=>t.jsx("div",{children:e.categoryImage&&e.categoryImage[0]&&t.jsx(t.Fragment,{children:t.jsx(G,{name:e.category,imageUrl:`${P}/${e.categoryImage[0].replace(/ /g,"%20")}`,handler:()=>U(e.category)})})},e._id))}),t.jsx("div",{className:"w-full border-t mt-5 border-[#9a9b9e] flex justify-between ",children:t.jsxs("div",{className:"relative inline-block text-left",ref:v,children:[t.jsx("div",{children:t.jsxs("button",{onClick:()=>I(!$),type:"button",className:"inline-flex w-full justify-center gap-x-1.5 mt-2  px-3 py-2 text-sm font-semibold text-gray-900  ",id:"menu-button","aria-expanded":"true","aria-haspopup":"true",children:["Sort",t.jsx("svg",{className:"-mr-1 h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:t.jsx("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z","clip-rule":"evenodd"})})]})}),$&&t.jsx("div",{className:"absolute left-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",children:t.jsxs("div",{className:"py-1",role:"none",children:[t.jsx("button",{onClick:()=>{M()},className:"text-gray-700 block px-4 py-2 text-sm",role:"menuitem",id:"menu-item-0",children:"Best selling product"}),t.jsx("button",{onClick:()=>{B()},className:"text-gray-700 block px-4 py-2 text-sm",role:"menuitem",id:"menu-item-0",children:"Price: Low to High"}),t.jsx("button",{onClick:()=>{z()},className:"text-gray-700 block px-4 py-2 text-sm",role:"menuitem",id:"menu-item-0",children:"Price: High to Low"})]})})]})}),t.jsx("div",{className:"grid grid-cols-2  md:grid-cols-2 lg:grid-cols-4 gap-4",children:C.map(e=>t.jsx("div",{children:e.productImage&&e.productImage[0]&&t.jsx(t.Fragment,{children:t.jsx(J,{productId:e._id,price:e.price,description:e.Description,name:e.productName,discountPrice:e==null?void 0:e.discountPrice,offerInPercentage:e.offerInPercentage,imageUrl:`${P}/${e.productImage[0].replace(/ /g,"%20")}`,onAddToCart:()=>A(e)})})},e._id))})]}),t.jsx("div",{className:"flex justify-center pt-2 pb-10 ",children:t.jsx("nav",{"aria-label":"Page navigation example",children:t.jsxs("ul",{className:"inline-flex -space-x-px text-base h-10",children:[t.jsx("li",{children:t.jsx("button",{onClick:()=>r(e=>Math.max(e-1,1)),disabled:s===1,className:`flex items-center justify-center px-4 h-10 leading-tight text-gray-500 bg-white border border-e-0 border-gray-300 rounded-l-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white ${s===1?"cursor-not-allowed":"cursor-pointer"}`,children:"Previous"})}),[...Array(w)].map((e,o)=>t.jsx("li",{children:t.jsx("button",{onClick:()=>r(o+1),className:`flex items-center justify-center px-4 h-10 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white ${s===o+1?"text-blue-600 bg-blue-50 hover:bg-blue-100 hover:text-blue-700 dark:border-gray-700 dark:bg-gray-700 dark:text-white":""}`,children:o+1})},o)),t.jsx("li",{children:t.jsx("button",{onClick:()=>r(e=>Math.min(e+1,w)),disabled:s===w,className:`flex items-center justify-center px-4 h-10 leading-tight text-gray-500 bg-white border border-gray-300 rounded-r-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white ${s===w?"cursor-not-allowed":"cursor-pointer"}`,children:"Next"})})]})})})]})};export{V as default};
