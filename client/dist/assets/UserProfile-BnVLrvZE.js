import{G as g,u as S,a as R,b as P,r as n,w as U,j as e,S as c,p as L,i as j,_ as u,e as $,h as H}from"./index-gIIwSxQ2.js";function V(r){return g({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M17 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}}]})(r)}function F(r){return g({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 000-1.41l-2.34-2.34a.996.996 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}}]})(r)}function B(r){return g({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}}]})(r)}const _="https://www.grabfood.life",A=()=>{const{user:r}=S(s=>s.userReducer),d=r==null?void 0:r._id,N=R(),w=P(),[y,p]=n.useState(!0),[i,m]=n.useState(!1),[h,f]=n.useState(!1),[x,b]=n.useState(null),[t,o]=n.useState({name:"",gender:"",email:"",phoneNumber:"",profileImage:""});n.useEffect(()=>{(async()=>{p(!0);try{const a=await j.get(`/user/get/${d}`);if(a&&a.data){const l=a.data.data;o({name:l.username,gender:l.gender,email:l.email,phoneNumber:l.phone,profileImage:l.profilePicture})}}catch(a){console.error("Error fetching user data:",a),u.error(a.response.data.message),a.response.data.message==="User is blocked"&&($.remove("token"),w(H()),N("/login"))}finally{p(!1)}})()},[d]);const I=s=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s),C=s=>/^[0-9]{10}$/.test(s),z=()=>{m(!0)},E=async()=>{if(!I(t.email)){u.error("Please enter a valid email address.");return}if(!C(t.phoneNumber)){u.error("Please enter a valid 10-digit phone number.");return}try{const s=new FormData;s.append("name",t==null?void 0:t.name),s.append("gender",t==null?void 0:t.gender),s.append("email",t==null?void 0:t.email),s.append("phoneNumber",t==null?void 0:t.phoneNumber),x&&s.append("profileImage",x);const a=await j.put(`/user/edit/${d}`,s,{headers:{"Content-Type":"multipart/form-data"}});a.status===200?(console.log("User profile updated successfully"),o(l=>({...l,profileImage:a.data.data.profilePicture}))):console.error("Error updating user profile"),m(!1)}catch(s){console.error("Error updating user profile:",s)}},v=(s,a)=>{if(s==="profileImage"){const l=a[0];b(l)}else o({...t,[s]:a})},k=s=>{b(s),o(a=>({...a,profileImage:URL.createObjectURL(s)}))},M=typeof t.profileImage=="string"?t.profileImage.startsWith("blob:")?t.profileImage:`${_}/${t.profileImage.replace(/ /g,"%20")}`:U;return e.jsxs("div",{className:"h-full",children:[h&&e.jsx("div",{className:"bg-gray-500/80 fixed w-full h-screen z-20 top-0 left-0"}),e.jsx("div",{className:"container flex flex-col items-center h-full mx-auto p-6 bg-white rounded-md shadow-md",children:e.jsx("div",{className:"flex flex-col justify-center items-center border-2 rounded-[10px] shadow w-[350px] h-[450px] mt-5",children:y?e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center p-4",children:[e.jsx(c,{circle:!0,height:128,width:128}),e.jsx(c,{height:30,width:200,className:"mt-6"}),e.jsx(c,{height:20,width:250,className:"mt-4"}),e.jsx(c,{height:20,width:250,className:"mt-2"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"relative w-32 h-32",children:e.jsx("img",{src:M,alt:"user",className:"w-full h-full object-cover rounded-full"})}),i&&e.jsx("button",{onClick:()=>f(!h),className:"p-1 bg-blue-500 text-white rounded-full",children:"Change Image"}),e.jsx("div",{children:e.jsx("div",{className:"font-semibold text-lg",children:r==null?void 0:r.name})})]}),e.jsxs("div",{className:"mt-6 flex flex-col justify-center items-center",children:[e.jsx("div",{className:"flex items-center mb-4",children:i?e.jsx("input",{type:"email",value:t==null?void 0:t.email,onChange:s=>v("email",s.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",placeholder:"Email"}):e.jsx("span",{children:t==null?void 0:t.email})}),e.jsx("div",{className:"flex w-full justify-center items-center mb-4",children:i?e.jsx("input",{type:"tel",value:t==null?void 0:t.phoneNumber,onChange:s=>v("phoneNumber",s.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5",placeholder:"Phone Number"}):e.jsx("span",{children:t==null?void 0:t.phoneNumber})})]}),e.jsx("div",{className:"flex items-center justify-between mt-10",children:i?e.jsxs("div",{className:"flex justify-center items-center gap-10",children:[e.jsxs("button",{onClick:E,className:"text-green-500 hover:underline cursor-pointer",children:[e.jsx(V,{size:20,className:"inline-block mb-1"}),"Save"]}),e.jsxs("button",{onClick:()=>m(!1),className:"text-red-500 hover:underline cursor-pointer",children:[e.jsx(B,{size:20,className:"inline-block mb-1"}),"Cancel"]})]}):e.jsxs("button",{onClick:z,className:"text-blue-500 hover:underline cursor-pointer",children:[e.jsx(F,{size:20,className:"inline-block mb-1"}),"Edit Profile"]})})]})})}),h&&e.jsx(L,{onClose:()=>f(!1),handleImageChange:k,aspectRatio:1/1,maxImage:1})]})};export{A as default};
